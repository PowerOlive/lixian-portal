!!!
html
  head
    meta(charset='utf8')
    link(href='http://cdn.staticfile.org/twitter-bootstrap/3.2.0/css/bootstrap.min.css',rel='stylesheet')
    script(src='http://cdn.staticfile.org/jquery/2.1.1-rc2/jquery.min.js')
    script(src='http://cdn.staticfile.org/twitter-bootstrap/3.2.0/js/bootstrap.min.js')
    script.
      $(function(){
        var $modal = $('form.vcode-template').modal({
          show: false
        });
        var img = $modal.find('img')[0]
        $modal.on('submit', function(ev){
          ev.preventDefault();
          $.post('vcode', $modal.serialize());
        });
        var fn = function(){
          $.get('vcode', function(vcode_data){
            if(vcode_data.length){
              if(!$modal.is(':visible')){
                $modal.modal('show');
              }
              if(img.src != vcode_data){
                console.log(img.src.length)
                console.log(vcode_data.length)
                img.src = vcode_data;
                $modal.find('input').val('');
              }
            }else{
              if($modal.is(':visible')){
                $modal.modal('hide');
              }
            }
            setTimeout(fn, 500);
          });
        };
        fn();
      });
    title lixian
  body
    form.modal.fade.vcode-template
      .modal-dialog
        .modal-content
          .modal-header
            button.close(type='button', data-dismiss='modal')
              span(aria-hidden='true') ×
              span.sr-only Close
            h4.modal-title 需要输入验证码
          .modal-body
            img
            input(placeholder='请输入验证码', name='vcode')
          .modal-footer
            button.btn.btn-default(type='button', onclick='$(this).closest("form").submit();') 确定
    iframe(src='iframe', style='border: none; position: fixed; left: 0; top: 0; width: 100%; height: 100%;', name='portal', target='portal')
